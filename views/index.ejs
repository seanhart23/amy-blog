<% include ./partials/header %>
<% include ./partials/imagecarousel %>
<br>
<div class='ui container'>
   <% if(currentUser){ %>
        <a href='/posts/new' class='ui secondary small button'>New Post</a><p></p>
    <% } %>
<div class="ui stackable mobile grid">
    <div class="twelve wide column">

<!-- PUSH LAST ITEM OF ARRAY TO FIRST -->

<% var date_sort_asc = function (date1, date2) {
  // This is a comparison function that will result in dates being sorted in
  // ASCENDING order. As you can see, JavaScript's native comparison operators
  // can be used to compare dates. This was news to me.
  if (date1 > date2) return 1;
  if (date1 < date2) return -1;
  return 0;
}; %>

<% blogsinorder = blogs.sort(date_sort_asc) %>

<!-- END FUNCTION -->
        <% for (let y=blogs.length - 1; y >= 0; y--){ %>
            <div class='border'>
                <div class='ui stackable mobile reversed grid'>
                <div class='nine wide column' id='preview'> 
                    <div class="meta">
                        <% var date = new Date(blogs[y].created); %>
                        <% var options = {weekday: "long", year: "numeric", month: "long", day: "numeric"};%>  
                        <span id='date'><%= date.toLocaleDateString('en-us', options) %></span>
                    </div>
                    <div class="item" id='title'>
                        <h2><%= blogs[y].title %></h2>
                    </div>
                    <div class="content">
                        <div class="description">
                            <p class='formattedText line-clamp'><%- blogs[y].summary %>...</p>
                        </div>
                        <div id='postDetail'>
                        <hr id='postLine'>
                        <div class="extra">
                            <span id='category'>Topic: <%= blogs[y].category1 %><% if(blogs[y].category2){ %>, <% }; %><%= blogs[y].category2 %><% if(blogs[y].category3){ %>, <% }; %></span>
                            <a href="/posts/<%= blogs[y]._id %>" id='postLink'>Read More . . .</a>
                        </div>
                        </div>
                    </div> 
                </div>
                <div class='seven wide column' id='imageDiv'>
                    <div id="image">
                        <img class="cover" src="<%= blogs[y].image %>">
                </div>
            </div>
            </div>
        </div>
        <br>
        <% } %>
        <div class='old'><a href='./categories/archive' id='old'>Older Posts ></a></div>
    </div>
    <% include ./partials/rightrail %><br>
</div>
<% include ./partials/footer %>