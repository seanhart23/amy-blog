<% include ./partials/header %>


<div class='ui container'>

<div class="ui grid">
    <div class="twelve wide column">
        <div class="meta">
            <% var date = new Date(blog.created); %>
            <% var options = {weekday: "long", year: "numeric", month: "long", day: "numeric"};%>  
            <span id='date'><%= date.toLocaleDateString('en-us', options) %></span>
        </div>
        <div class="item" id='title'>
            <h2><%= blog.title %></h2>
        </div><br>
    <div class="ui top attached">
        <div class="item">
            <img class="ui fluid image" src="<%= blog.image %>" width="300px">
            <div class="description" id='blogBody'>
                <p><%- blog.body %></p>
            </div>
            <%if(currentUser){ %>
            <span id='button'><a href="/posts/<%= blog._id %>/edit" class="ui mini primary button">Edit</a></span>
            <span id='button'><form method="POST" action="/posts/<%= blog._id %>?_method=DELETE" id="delete">
                <button class="ui mini button">Delete</button>
            </form></span>
            <% } %>
            </div>
    </div>
    <div>
        <h2>Comments</h2><h3 id='commentCount'>(<%= blog.comments.length %> Comments)</h3>
        <br><br><a href='<%= blog._id %>/comments/new' class='ui mini button' id='commentButton'>Add a comment</a>
        <% blog.comments.forEach(function(comment) {%>
        <div class='commentBox'>
            <% var date = new Date(comment.created); %>
            <span id='date'><%= date.toDateString('en-US') %></span><p></p>
        <strong>
            <%= comment.author %>
        </strong><br>
            <%= comment.text %>
        <% if(currentUser){ %>
            <form action="/posts/<%= blog._id %>/comments/<%= comment._id %>?_method=DELETE" method='POST' class='delete-form'>
                <br>
                <input type='submit' class="ui mini red button" value='Delete'>
            </form>
        <% } %>
        </div>
        <% }) %>
    </div>
    </div>
    <% include ./partials/rightrail %>
</div>

<% include ./partials/footer %>